name: Read YAML

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  read_yaml:
    runs-on: ubuntu-latest
    outputs:
      data: ${{ steps.parser.outputs.data }}
    steps:
      - uses: actions/checkout@v3
      - name: Parse YAML
        id: parser
        shell: python
        run: |
          import yaml
          import os

          with open('config_test.yml', 'r') as f:
            config_file = yaml.safe_load(f)

          outputs = dict()
          outputs['data'] = config_file.get('version', '')

          if "GITHUB_OUTPUT" in os.environ:
            with open(os.environ["GITHUB_OUTPUT"], "a") as f:
              print(f"data={outputs['data']}", file=f)

  validate:
    needs: read_yaml
    runs-on: ubuntu-latest
    steps:
      - name: Check
        run: echo ${{ needs.read_yaml.outputs.data }} 
          


